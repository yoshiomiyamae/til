x86 Assembler
===
基本的にはアセンブラがよしなにしてくれるが、中身を知らないまま書くのは気持ちが悪いので勉強する。

## レジスタ
### 汎用レジスタ
| 31 --- 16 | 15 --- 8 | 7 --- 0 | 16bit | 32bit | 説明 |
|---|:-:|:-:|:-:|:-:|---|
| | ah | al | ax | eax | アキュムレータレジスタ。算術演算操作の結果が格納される。 |
| | bh | bl | bx | ebx | ベースレジスタ。セグメントモードでのｄｓに格納されたデータのポインタ。 |
| | ch | cl | cx | ecx | カウンタレジスタ。シフトローテート命令とループ命令に使用される。 |
| | dh | dl | dx | edx | データレジスタ。算術演算操作とI/O操作に使用される。 |
| | | | bp | ebp | スタックベースポインタレジスタ。スタックのベースのポインタ。 |
| | | | si | esi | ソースレジスタ。ストリーム操作でのソースへのポインタ。 |
| | | | di | edi | デスティネーションレジスタ。ストリーム操作でのデスティネーションへのポインタ。 |
| | | | sp | esp | スタックポインターレジスタ。スタックのトップのポインタ。 |

### EFLAGSレジスタ
| 31 | 30 | 29 | 28 | 27 | 26 | 25 | 24 | 23 | 22 | 21 | 20 | 19 | 18 | 17 | 16 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | IDフラグ(ID) | 仮想割込保留フラグ(VIP) | 仮想割込フラグ(VIF) | アライメントチェックフラグ(AC) | 仮想8086モード(VM) | 再開フラグ(RF) |

| 15 | 14 | 13 | 12 | 11 | 10 | 9 | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| 0 | ネストタスクフラグ(NT) | I/O特権レベルフィールド(IOPL) || オーバーフローフラグ(OF) | 方向フラグ(DF) | 割込有効フラグ(IF) | トラップフラグ(TF) | 符号フラグ(SF) | ゼロフラグ(ZF) | 0 | 調整フラグ(AF) | 0 | パリティフラグ(PF) | 0 | キャリーフラグ(CF) |

| フラグ名 | 種類 | 説明 |
|---|---|---|
| IDフラグ(ID) | システムフラグ |  |
| 仮想割込保留フラグ(VIP) | システムフラグ |  |
| 仮想割込フラグ(VIF) | システムフラグ |  |
| アライメントチェックフラグ(AC) | システムフラグ |  |
| 仮想8086モード(VM) | システムフラグ |  |
| 再開フラグ(RF) | システムフラグ |  |
| ネストタスクフラグ(NT) | システムフラグ |  |
| I/O特権レベルフィールド(IOPL) | システムフラグ |  |
| オーバーフローフラグ(OF) | 状態フラグ |  |
| 方向フラグ(DF) | 操作フラグ |  |
| 割込有効フラグ(IF) | システムフラグ |  |
| トラップフラグ(TF) | システムフラグ |  |
| 符号フラグ(SF) | 状態フラグ |  |
| ゼロフラグ(ZF) | 状態フラグ |  |
| 調整フラグ(AF) | 状態フラグ |  |
| パリティフラグ(PF) | 状態フラグ |  |
| キャリーフラグ(CF) | 状態フラグ |  |

### セグメントレジスタ
| 名前 | 説明|
|:-:|---|
| cs | コードセグメント |
| ss | スタックセグメント |
| ds | データセグメント |
| es | エクストラデータセグメント |
| fs |  |
| gs |  |

### 16bit
#### ModR/M
reg(register)とr/mの内容を示すための値

| 7 --- 6 | 5 --- 3 | 2 --- 0 |
|:-:|:-:|:-:|
| mode | register | r/m |

##### 組み合わせ
| r/m \\ mode | `00` | `01` | `10` | `11` |
|:-:|---|---|---|---|
| `000` | [bx + si] | [bx + si + disp8] | [bx + si + disp16] | al / ax |
| `001` | [bx + di] | [bx + di + disp8] | [bx + di + disp16] | cl / cx |
| `010` | [bp + si] | [bp + si + disp8] | [bp + si + disp16] | dl / dx |
| `011` | [bp + di] | [bp + di + disp8] | [bp + di + disp16] | bl / bx |
| `100` | [si] | [si + disp8] | [si + disp16] | ah / sp |
| `101` | [di] | [di + disp8] | [di + disp16] | ch / bp |
| `110` | [disp16]<sup>*注</sup> | [bp + disp8] | [bp + disp16] | dh / si |
| `111` | [bx] | [bx + disp8] | [bx + disp16] | bh / di |
\*注: `mode=00 r/m=110`には特別なルールがあるので、`[bp]`を実現したい時には、`mode=01 r/m=110 disp8=0`([bp + 0])と指定する必要がある。

詳細は以下の通り

##### mode
regとr/mの内容を指定する。

| mode (bin) | disp |
|:-:|---|
| `00` | レジスタ+レジスタ。(dispなし)但し、`r/m=110`の時、disp16 |
| `01` | レジスタ+disp8 |
| `10` | レジスタ+disp16 |
| `11` | レジスタ。`/digit`オペランドで使用される。 |

##### disp
diplacementの略。メモリのアドレス。

##### register

| レジスタ | register (bin) |
|:-:|:-:|
| `al` `ax` | `000` |
| `cl` `cx` | `001` |
| `dl` `dx` | `010` |
| `bl` `bx` | `011` |
| `ah` `sp` | `100` |
| `ch` `bp` | `101` |
| `dh` `si` | `110` |
| `bh` `di` | `111` |

##### r/m
register / memoryの略。

| r/m (bin) | オペランドアドレス |
|:-:|:-:|
| `000` | [bx + si + dispなし/8/16] |
| `001` | [bx + di + dispなし/8/16] |
| `010` | [bp + si + dispなし/8/16] |
| `011` | [bp + di + dispなし/8/16] |
| `100` | [si + dispなし/8/16] |
| `101` | [di + dispなし/8/16] |
| `110` | [bp + dispなし/8/16] 但し、`mode=0`の時、[disp16] |
| `111` | [bx + dispなし/8/16] |

## 命令セット
### オペランド
#### 命令欄
| オペランド | 説明 |
|---|---|
| `rel8` | 命令の終りの前の128bytesから命令の終りの後の127bytesまでの範囲の相対アドレス。 |
| `rel16`| アセンブル結果の命令と同じコード・セグメント内の相対アドレス。<br/>オペランド・サイズ属性が16bitsである命令に適用される。 |
| `rel32`| アセンブル結果の命令と同じコード・セグメント内の相対アドレス。<br/>オペランド・サイズ属性が32bitsである命令に適用される。 |
| `ptr16:16`| 一般的に命令のコード・セグメントとは異なるコード・セグメント内のfarポインタ。<br/>16:16という表記法は、ポインタの値が2つの部分からなっていることを示す。<br/>コロンの左側の値は、16bitsのセレクタ、すなわちコード・セグメント・レジスタに送られる値である。<br/>右側の値はデスティネーション・セグメント内のオフセットに対応する。<br/>命令のオペランド・サイズ属性が16bitsである場合に使用される。 |
| `ptr16:32`| 一般的に命令のコード・セグメントとは異なるコード・セグメント内のfarポインタ。<br/>16:32という表記法は、ポインタの値が2つの部分からなっていることを示す。<br/>コロンの左側の値は、16bitsのセレクタ、すなわちコード・セグメント・レジスタに送られる値である。<br/>右側の値はデスティネーション・セグメント内のオフセットに対応する。<br/>命令のオペランド・サイズ属性が32bitsである場合に使用される。 |
| `r8` | 汎用バイトレジスタ`al` `ah` `bl` `bh` `cl` `ch` `dl` `dh`のいずれか。  |
| `r16` | 汎用ワードレジスタ`ax` `bx` `cx` `dx` `bp` `si` `di` `sp`のいずれか。  |
| `r32` | 汎用ダブルワードレジスタ`eax` `ebx` `ecx` `edx` `ebp` `esi` `edi` `esp`のいずれか。  |
| `imm8` | 即値バイト値。記号imm8は-128から+127までの符号付き数値である。<br/>imm8がワードまたはダブルワードのオペランドと結合される命令については、即値は符号拡張されてワードまたはダブルワードを構成する。その場合は、ワードの上位バイトは即値の最上位ビットで埋められる。 |
| `imm16` | オペランド・サイズ属性が16bitsである命令に使用される即値ダブルワード値。<br/>これには-32,768から+32,767までの数値を使用できる。 |
| `imm32` | オペランド・サイズ属性が32ビットである命令に使用される即値ダブルワード値。<br/>これには-2,147,483,648から+2,147,483,647までの数値を使用できる。 |
| `m8` | 通常、変数名または配列名として表されるが、ds:(e)siまたはes:(e)diレジスタによってアドレス指定されるバイト・メモリ・オペランド。<br/>これはストリング命令およびxlat命令に対してのみ使用される。 |
| `m16` | 通常、変数名または配列名として表されるが、ds:(e)siまたはes:(e)diレジスタによってアドレス指定されるワード・メモリ・オペランド。<br/>これはストリング命令に対してのみ使用される。 |
| `m32` | 通常、変数名または配列名として表されるが、ds:(e)siまたはes:(e)diレジスタによってアドレス指定されるダブルワード・メモリ・オペランド。<br/>これはストリング命令に対してのみ使用される。 |
| `m64` | 通常、変数名または配列名として表されるが、ds:(e)siまたはes:(e)diレジスタによってアドレス指定されるクワッドワード・メモリ・オペランド。<br/>これはcmpxchg8b命令に対してのみ使用される。 |
| `m128` | 通常、変数名または配列名として表されるが、ds:(e)siまたはes:(e)diレジスタによってアドレス指定されるダブル・クワッドワード・メモリ・オペランド。<br/>これはSSE, SSE2, SSE3に対してのみ使用される。 |
| `r/m8` | r/m(後述) |
| `r/m16` | r/m(後述)|
| `r/m32` | r/m(後述) |
| `m16:16` | 2つの数値からなるfarポインタを内容とするメモリ・オペランド。<br/>コロンの左側の数値はポインタのセグメント・セレクタに対応し、右側の数値はポインタのオフセットに対応する。 |
| `m16:32` | 2つの数値からなるfarポインタを内容とするメモリ・オペランド。<br/>コロンの左側の数値はポインタのセグメント・セレクタに対応し、右側の数値はポインタのオフセットに対応する。 |
| `m16&16` | サイズがアンパーサンド記号の左側と右側に示されるデータ項目の対からなるメモリ・オペランド。<br/>すべてのメモリアドレス指定モードが可能である。<br/>bound命令で使用され、配列インデックスの上限および下限を内容とするオペランドを提供する。 |
| `m16&32` | サイズがアンパーサンド記号の左側と右側に示されるデータ項目の対からなるメモリ・オペランド。<br/>すべてのメモリアドレス指定モードが可能である。<br/>lidtおよびlgdtで使用され、対応するgdtrおよびidtrレジスタのlimitフィールドにロードするワード、およびベース・フィールドにロードするダブルワードを提供する。 |
| `m32&32` | サイズがアンパーサンド記号の左側と右側に示されるデータ項目の対からなるメモリ・オペランド。<br/>すべてのメモリアドレス指定モードが可能である。<br/>bound命令で使用され、配列インデックスの上限および下限を内容とするオペランドを提供する。 |
| `moffs8` | mov命令の一部のバリエーションによって使用されるバイト、ワード、またはダブルワード型のシンプルメモリ変数（メモリ・オフセット）。<br/>実際のアドレスは、セグメント・ベースからのシンプル・オフセットによって与えられる。<br/>命令にはModR/Mバイトは使用されない。<br/>8はセグメントのサイズであり、これは命令のアドレスサイズ属性によって決まる。 |
| `moffs16` | mov命令の一部のバリエーションによって使用されるバイト、ワード、またはダブルワード型のシンプルメモリ変数（メモリ・オフセット）。<br/>実際のアドレスは、セグメント・ベースからのシンプル・オフセットによって与えられる。<br/>命令にはModR/Mバイトは使用されない。<br/>16はセグメントのサイズであり、これは命令のアドレスサイズ属性によって決まる。 |
| `moffs32` | mov命令の一部のバリエーションによって使用されるバイト、ワード、またはダブルワード型のシンプルメモリ変数（メモリ・オフセット）。<br/>実際のアドレスは、セグメント・ベースからのシンプル・オフセットによって与えられる。<br/>命令にはModR/Mバイトは使用されない。<br/>32はセグメントのサイズであり、これは命令のアドレスサイズ属性によって決まる。 |
| `sreg` | セグメント・レジスタ。セグメント・レジスタのビット割り当ては、`es=0` `cs=1` `ss=2` `ds=3` `fs=4` `gs=5` |
| `m32fp` | 単精度浮動小数点数のメモリ・オペランド。x87 FPU浮動小数点命令のオペランドとして使用される浮動小数点の値が指定される。 |
| `m64fp` | 倍精度浮動小数点数のメモリ・オペランド。x87 FPU浮動小数点命令のオペランドとして使用される浮動小数点の値が指定される。 |
| `m80fp` | 拡張倍精度浮動小数点数のメモリ・オペランド。x87 FPU浮動小数点命令のオペランドとして使用される浮動小数点の値が指定される。 |
| `m16int` | ワード整数のメモリ・オペランド。x87 FPU整数命令のオペランドとして使用される整数が指定される。 |
| `m32int` | ダブルワード整数のメモリ・オペランド。x87 FPU整数命令のオペランドとして使用される整数が指定される。 |
| `m64int` | クワッドワード整数のメモリ・オペランド。x87 FPU整数命令のオペランドとして使用される整数が指定される。 |
| `st` or `st(0)` | FPUレジスタスタックの一番上の要素 |
| `st(i)` | FPUレジスタスタックの一番上からi番目の要素 (i←0〜7) |
| `mm` | MMX®テクノロジ・レジスタ。64-bit MMXテクノロジ・レジスタmm0からmm7まで。 |
| `mm/m32` | MMXテクノロジ・レジスタの下位32bitsまたは32bitsのメモリ・オペランド。<br/>64bitsのMMXテクノロジ・レジスタはmm0からmm7まで。<br/>メモリの内容は、実効アドレス計算によって与えられるアドレスにある。 |
| `mm/m64` | MMXテクノロジ・レジスタまたは64bitsのメモリ・オペランド。<br/>64bitsのMMXテクノロジ・レジスタはmm0からmm7まで。<br/>メモリの内容は、実効アドレス計算によって与えられるアドレスにある。 |
| `xmm` | XMMレジスタ。128bitsのXMMレジスタは、xmm0からxmm7まで。 |
| `xmm/m32` | XMMレジスタまたは32bitsのメモリ・オペランド。<br/>128bitsのMMXテクノロジ・レジスタはmm0からmm7まで。<br/>メモリの内容は、実効アドレス計算によって与えられるアドレスにある。 |
| `xmm/m64` | XMMレジスタまたは64bitsのメモリ・オペランド。<br/>128bitsのMMXテクノロジ・レジスタはmm0からmm7まで。<br/>メモリの内容は、実効アドレス計算によって与えられるアドレスにある。 |
| `xmm/m128` | XMMレジスタまたは128bitsのメモリ・オペランド。<br/>128bitsのMMXテクノロジ・レジスタはmm0からmm7まで。<br/>メモリの内容は、実効アドレス計算によって与えられるアドレスにある。 |

#### オペコード欄
| オペランド | 説明 |
|---|---|
| `/digit` | `0`から`7`までの数字で、命令のModR/Mバイトがr/mオペランドだけを使用することを示す。regフィールドには、命令のオペコードを拡張する数字が入っている。 |
| `/r` | 命令のModR/Mバイトに、レジスタ・オペランドとr/オペランドの両方があることを示す。 |
| `cb` | オペコードの後に続く1byteの値であり、コード・オフセット、コード・セグメント・レジスタの新しい値を指定することができる。 |
| `cw` | オペコードの後に続く2bytesの値であり、コード・オフセット、コード・セグメント・レジスタの新しい値を指定することができる。 |
| `cd` | オペコードの後に続く4bytesの値であり、コード・オフセット、コード・セグメント・レジスタの新しい値を指定することができる。 |
| `cp` | オペコードの後に続く6bytesの値であり、コード・オフセット、コード・セグメント・レジスタの新しい値を指定することができる。 |
| `ib` | オペコード、ModM/Rバイト、またはスケール・インデクッス・バイトの後に続く命令への1byteの即値オペランドである。オペランドが符号付きかどうかは、オペコードによって決まる。すべてのワードおよびダブルワードが下位バイトから先に示される。 |
| `iw` | オペコード、ModM/Rバイト、またはスケール・インデクッス・バイトの後に続く命令への2bytesの即値オペランドである。オペランドが符号付きかどうかは、オペコードによって決まる。すべてのワードおよびダブルワードが下位バイトから先に示される。 |
| `id` | オペコード、ModM/Rバイト、またはスケール・インデクッス・バイトの後に続く命令への4byteの即値オペランドである。オペランドが符号付きかどうかは、オペコードによって決まる。すべてのワードおよびダブルワードが下位バイトから先に示される。 |
| `+rb` | 0から7までのレジスタコードであり、+符号の左側に現れる16進バイトに加算されて、単一のオペコード・バイトを構成する。 |

### call (処理呼び出し)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `call rel16` | `E8 cw` | 7+m |  |
| `call r/m16` | `FF /2` | 7+m/10+m |  |
| `call ptr16:16` | `9A cd` | 17+m, pm=34+m |  |
| `call ptr16:16` | `9A cd` | pm=52+m |  |
| `call ptr16:16` | `9A cd` | pm=86+m |  |
| `call ptr16:16` | `9A cd` | pm=94+4x+m |  |
| `call ptr16:16` | `9A cd` | ts |  |
| `call m16:16` | `FF /3` | 22+m, pm=38+m |  |
| `call m16:16` | `FF /3` | pm=56+m |  |
| `call m16:16` | `FF /3` | pm=90+m |  |
| `call m16:16` | `FF /3` | pm=98+4x+m |  |
| `call m16:16` | `FF /3` | 5+ts |  |
| `call rel32` | `E8 cd` | 7+m |  |
| `call r/m32` | `FF /2` | 7+m/10+m |  |
| `call ptr16:32` | `9A cp` | 17+m, pm=34+m |  |
| `call ptr16:32` | `9A cp` | pm=52+m |  |
| `call ptr16:32` | `9A cp` | pm=86+m |  |
| `call ptr16:32` | `9A cp` | pm=94+4x+m |  |
| `call ptr16:32` | `9A cp` | ts |  |
| `call m16:32` | `FF /3` | 22+m, pm=38+m |  |
| `call m16:32` | `FF /3` | pm=56+m |  |
| `call m16:32` | `FF /3` | pm=90+m |  |
| `call m16:32` | `FF /3` | pm=98+4x+m |  |
| `call m16:32` | `FF /3` | 5+ts |  |

### cli (割込フラグのクリア)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `cli` | `FA` | 3 | 割込みフラグ(IF)のクリア(割込の無効化) |

### int (割込処理呼び出し)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `int 3` | `CC` | 33 | デバッガへのトラップ |
| `int 3` | `CC` | pm=59 | デバッガへのトラップ |
| `int 3` | `CC` | pm=99 | デバッガへのトラップ |
| `int 3` | `CC` | pm=119 | デバッガへのトラップ |
| `int 3` | `CC` | ts | デバッガへのトラップ |
| `int imm8` | `CD ib` | 37 |  |
| `int imm8` | `CD ib` | pm=59 |  |
| `int imm8` | `CD ib` | pm=99 |  |
| `int imm8` | `CD ib` | pm=119 |  |
| `int imm8` | `CD ib` | ts |  |
| `into` | `CE` | Fail:3, pm=3; pass:35 |  |
| `into` | `CE` | pm=59 |  |
| `into` | `CE` | pm=99 |  |
| `into` | `CE` | pm=119 |  |
| `into` | `CE` | ts |  |

#### 割込処理一覧
| コード (imm8) | サービス名 | 説明 |
|:-:|---|---|
| `0x10` | ビデオサービス |  |
| `0x11` | システムデバイス情報取得 |  |
| `0x12` | ローメモリサイズ取得 |  |
| `0x13` | ディスクサービス |  |
| `0x14` | シリアルポートサービス |  |
| `0x15` | システムサービス |  |
| `0x16` | キーボードサービス |  |
| `0x17` | パラレルポートサービス |  |
| `0x18` | ブートフォルト処理 |  |
| `0x19` | ブートストラップ処理 |  |
| `0x1A` | 時刻・日付サービス |  |
| `0x1B` | コントロール・ブレイク信号 |  |
| `0x1C` | ユーザータイマー割込み |  |
| `0x1D` | ビデオパラメータテーブル(VPT) |  |
| `0x1E` | フロッピーディスクパラメーターテーブル(DTP) |  |
| `0x1F` | ビデオグラフィック文字テーブル |  |
| `0x41` `0x46` | 固定ディスクパラメータテーブル(FDPTs) |  |
| `0x4A` | リアルタイムクロック割込み |  |
| `0x4F` | ビデオBIOS拡張機能 |  |

##### ビデオサービス
| 機能 | ファンクションコード | パラメータ | 返り値 | 補足 |
|---|:-:|---|---|---|
| ビデオモードの設定 | `ah: 0x00` | `al: ビデオモード` | `al: ビデオモードフラグ / CRTコントローラモード` |  |
| テキストモードのカーソル形状設定 | `ah: 0x01` | `ch: スキャン開始行` `cl: スキャン終了行` |  | 通常、文字のセルは0〜7の8本のスキャンラインを持っていますので、cx=0x0607は通常の下線カーソルになり、cx=0x0007は塗りつぶしカーソルになります。<br/>chの5bit目がセットされている場合、カーソルを表示しない事を示すことが多いので、cx=0x2607は見えないカーソルということになります。<br/>いくつかのビデオカードは0ｘ0〜0xfの16本のスキャンラインを持っています。また、いくつかのビデオカードはchの5bit目のフラグを無視します。その場合には、chをclより大きくします。(cx=0x0706等) |
| カーソル位置の設定 | `ah: 0x02` | `bh: ページ番号` `dh: 行` `dl: 列` |  |  |
| カーソル位置とカーソル形状の取得 | `ah: 0x03` | `bh: ページ番号` | `ax: 0x0000` `ch: スキャン開始行` `スキャン終了行` `dh: 行` `dl: 列` |  |
| ライトペンの位置取得(VGAシステムでは動かない) | `ah: 0x04` | `ah: ステータス` `bx: ピクセルのx座標` `ch: ピクセルのy座標` `cl: モード0x0f〜0x10でのピクセル行番号` `dh: 文字のy座標` `dl: 文字のx座標` |  | 返り値のステータスはトリガーが引かれていると`1`、引かれていないと`0`が入るらしい。<br/>正直良くわからないしテストのしようが無い |
| 現在のディスプレイページの選択 | `ah: 0x05` | `al: ページ番号` |  |  |
| 上にスクロール | `ah: 0x06` | `al: スクロールする行数` `bh: 上位4bits背景色、下位4bits前景色` `ch: スクロールする領域の左上行番号` `cl: スクロールする領域の左上列番号` `dh: スクロールする領域の右下行番号` `dl: スクロールする領域の右下列番号` |  | bh=0x43の場合、背景色が赤で、前景色がシアンになる。 |
| 下にスクロール | `ah: 0x07` | `al: スクロールする行数` `bh: 上位4bits背景色、下位4bits前景色` `ch: スクロールする領域の左上行番号` `cl: スクロールする領域の左上列番号` `dh: スクロールする領域の右下行番号` `dl: スクロールする領域の右下列番号` |  | bh=0x43の場合、背景色が赤で、前景色がシアンになる。 |
| カーソル位置の文字と属性取得 | `ah: 0x08` | `bh: ページ番号` | `ah: 文字色` `al: 文字` |  |
| カーソル位置に属性付き文字を書込む | `ah: 0x09` | `bh: ページ番号` `bl: 文字色` `al: 文字` `cx: 繰り返し数` |  |  |
| カーソル位置に文字を書き込む |  `ah: 0x0A` | `bh: ページ番号` `al: 文字` `cx: 繰り返し数` |  |  |
| 背景/罫線色の設定 | `ah: 0x0B` `bh: 0x00` | `bl: 背景/罫線色` |  |  |
| パレットの設定 | `ah: 0x0B` `bh: 0x01` | `bl: パレットID` |  |  |
| ピクセルの書き込み | `ah: 0x0C` | `al: 色番号` `bh: ページ番号` `cx: x座標` `dx: y座標` |  |  |
| ピクセルの読み込み | `ah: 0x0D` | `bh: ページ番号` `cx: x座標` `dx: y座標` |  |  |
| テレタイプ出力 | `ah: 0x0E` | `al: 文字` `bh: ページ番号` `bl: 文字色` |  |  |
| 現在のビデオモード取得 | `ah: 0x0F` |  | `al: ビデオモード` `ah: キャラクタ行数` `現在のページ番号` |  |

###### 色表
| 色番号 | 色 |
|:-:|---|
| `0x0` | <font color="black">黒</font> |
| `0x1` | <font color="blue">青</font> |
| `0x2` | <font color="green">緑</font> |
| `0x3` | <font color="cyan">シアン</font> |
| `0x4` | <font color="red">赤</font> |
| `0x5` | <font color="magenta">マゼンタ</font> |
| `0x6` | <font color="brown">茶</font> |
| `0x7` | <font color="silver">薄灰</font> |
| `0x8` | <font color="gray">濃灰</font> |
| `0x9` | <font color="lightblue">薄青</font> |
| `0xA` | <font color="lightgreen">薄緑</font> |
| `0xB` | <font color="lightcyan">薄シアン</font> |
| `0xC` | <font color="lightcoral">薄赤</font> |
| `0xD` | <font color="hotpink">薄マゼンタ</font> |
| `0xE` | <font color="yellow">黄</font> |
| `0xF` | <font color="white">白</font> |

##### キーボードサービス
| 機能 | ファンクションコード | 返り値 | 補足 |
|---|:-:|---|---|---|
| キー入力の読み込み | `ah: 0x00` | `al: 入力文字` |  |
| キーボードバッファ状態の取得 | `ah: 0x01` |  |  |
| キーボード状態の取得 | `ah: 0x02` |  |  |
| 繰り返し係数の設定 | `ah: 0x03` |  |  |
| 打鍵シミュレーション | `ah: 0x05` |  |  |
| キーボードIDの取得 | `ah: 0x0A` |  |  |
| 拡張キーの取得 | `ah: 0x10` |  |  |
| 拡張キーボードバッファ状態の取得 | `ah: 0x11` |  |  |
| 拡張キーボード状態の取得 | `ah: 0x12` |  |  |

##### ディスクサービス
| 機能 | ファンクションコード | パラメータ | 返り値 | 補足 |
|---|:-:|---|---|---|---|
| ディスクドライブのリセット | `ah: 0x00` | `dl: ドライブ番号` | `cf: エラー時にセット` |  |
| 最後のドライブ操作の状態取得 | `ah: 0x01` | `dl: ドライブ番号` | `ah: 結果コード` `cf: エラー時にセット、エラー無しでクリア` |  |
| ドライブからセクタを読み込み | `ah: 0x02` | `al: 読み込むセクタ数` `ch: シリンダ番号` `cl: セクタ番号` `dh: ヘッド番号` `dl: ドライブ番号` `es:bx: バッファアドレスのポインタ` | `cf: エラー時にセット、エラー無しでクリア` `結果コード` `al: 実際に読み込んだセクタ数` |  |
| ドライブにセクタを書き込み | `ah: 0x03` | `al: 書き込むセクタ数` `ch: シリンダ番号` `cl: セクタ番号` `dh: ヘッド番号` `dl: ドライブ番号` `es:bx: バッファアドレスのポインタ` | cf: エラー時にセット、エラー無しでクリア` `結果コード` `al: 実際に書き込んだセクタ数` |  |
| セクタの検証 | `ah: 0x04` | `al: 検証するセクタ数` `ch: シリンダ番号` `cl: セクタ番号` `dh: ヘッド番号` `dl: ドライブ番号` `es:bx: バッファアドレスのポインタ` | cf: エラー時にセット、エラー無しでクリア` `結果コード` `al: 実際に検証したセクタ数` |  |
| トラックのフォーマット | `ah: 0x05` | `al: フォーマットするセクタ数` `ch: シリンダ番号` `cl: セクタ番号` `dh: ヘッド番号` `dl: ドライブ番号` `es:bx: バッファアドレスのポインタ` | `cf: エラー時にセット、エラー無しでクリア` `ah: 結果コード` | PC/XT 286, AT, PS/1, PS/2向けには4bytesアドレスフィールドと言うのが有るみたいだがよくわからない |
| トラックのフォーマットとバッドセクタフラグの設定 | `ah: 0x06` | `al: インターリーブ` `ch: シリンダ番号` `cl: セクタ番号` `dh: ヘッド番号` `dl: ドライブ番号` | `cf: エラー時にセット、エラー無しでクリア` `ah: 結果コード` |  |
| トラックから始まるドライブのフォーマット | `ah: 0x07` | `al: インターリーブ` `ch: シリンダ番号` `cl: セクタ番号` `dh: ヘッド番号` `dl: ドライブ番号` | `cf: エラー時にセット、エラー無しでクリア` `ah: 結果コード` | よくわからない |
| ドライブパラメータの読み込み | `ah: 0x08` |  |  |  |
| ディスクコントローラーの初期化 | `ah: 0x09` |  |  | ハードディスクのみ |
| ドライブからロングセクタを読み込み | `ah: 0x0A` |  |  | ハードディスクのみ |
| ドライブにロングセクタを書き込み | `ah: 0x0B` |  |  | ハードディスクのみ |
| ドライブヘッドをシリンダに移動 | `ah: 0x0C` |  |  | ハードディスクのみ |
| ディスクドライブのリセット | `ah: 0x0D` |  |  | ハードディスクのみ |
| コントローラーの読み込みテスト | `ah: 0x0E` |  |  | PS/2システムのハードディスクのみ |
| コントローラーの書き込みテスト | `ah: 0x0F` |  |  | PS/2システムのハードディスクのみ |
| ドライブの準備が完了しているかどうかのテスト | `ah: 0x10` |  |  | ハードディスクのみ |
| ドライブの再校正 | `ah: 0x11` |  |  | ハードディスクのみ |
| コントローラRAMのテスト | `ah: 0x12` |  |  | PS/2システムのハードディスクのみ |
| ドライブのテスト | `ah: 0x13` |  |  | PS/2システムのハードディスクのみ |
| コントローラーの診断 | `ah: 0x14` |  |  | ハードディスクのみ |
| ドライブ種類の読み込み | `ah: 0x15` |  |  |  |
| メディア変更の検出 | `ah: 0x16` |  |  | フロッピーディスクのみ |
| フォーマットのためのメディアタイプの設定 | `ah: 0x17` |  |  | フロッピーディスクのみ<br/>DOS3.1以下で使用される |
| フォーマットのためのメディアタイプの設定 | `ah: 0x18` |  |  | フロッピーディスクのみ<br/>DOS3.2以上で使用される |
| Park Heads | `ah: 0x19` |  |  | 公園頭？よくわからない<br/>それとも駐車の方のparkで、ヘッドを収まるべきところに収めるということだろうか。 |
| 拡張が有効かどうかのテスト | `ah: 0x41` |  |  | EXT<sup>*注</sup> |
| ドライブからセクタを読み込み | `ah: 0x42` |  |  | EXT<sup>*注</sup> |
| ドライブにセクタを書き込み | `ah: 0x43` |  |  | EXT<sup>*注</sup> |
| セクタの検証 | `ah: 0x44` |  |  | EXT<sup>*注</sup> |
| ドライブのロック/アンロック | `ah: 0x45` |  |  | EXT<sup>*注</sup> |
| ドライブの取り出し | `ah: 0x46` |  |  | EXT<sup>*注</sup> |
| ドライブヘッドをセクタに移動 | `ah: 0x47` |  |  | EXT<sup>*注</sup> |
| ドライブパラメータの読み込み | `ah: 0x48` |  |  | EXT<sup>*注</sup> |
| メディア変更の検出 | `ah: 0x49` |  |  | EXT<sup>*注</sup> |
\*注: 8GB以上のハードディスクドライブをサポートするために、1990年代に書かれたディスクサービスの拡張機能

###### ドライブ
| ドライブ番号 (dl) | ドライブ |
|:-:|---|
| `0x00` | 1番目のフロッピーディスクドライブ (ドライブA) |
| `0x01` | 2番目のフロッピーディスクドライブ (ドライブB) |
| `0x80` | 1番目のハードディスクドライブ |
| `0x81` | 2番目のハードディスクドライブ |

### jcc (条件付き3ャンプ)
沢山あるように見えるが、実4エイリアスが多いだけである。
#### je 同じ / jz (ZF=1)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `je/jz rel8` | `74 cb` | 7+m, 3 | ショートジャンプ |
| `je/jz rel16` | `0F 84 cw` | 7+m, 3 | ニアジャンプ |
| `je/jz rel32` | `0F 84 cd` | 7+m, 3 | ニアジャンプ |

#### jne 等しくない / jnz (ZF=0)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jne/jnz rel8` | `75 cb` | 7+m, 3 | ショートジャンプ |
| `jne/jnz rel16` | `0F 85 cw` | 7+m, 3 | ニアジャンプ |
| `jne/jnz rel32` | `0F 85 cd` | 7+m, 3 | ニアジャンプ |

#### jg より大きい / jnle 以下ではない (ZF=0 & SF=OF) (符号あり)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jg/jnle rel8` | `7F cb` | 7+m, 3 | ショートジャンプ |
| `jg/jnle rel16` | `0F 8F cw` | 7+m, 3 | ニアジャンプ |
| `jg/jnle rel32` | `0F 8F cd` | 7+m, 3 | ニアジャンプ |

#### jge 以上 / jnl より小さくない (SF=OF) (符号あり)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jge/jnl rel8` | `7D cb` | 7+m, 3 | ショートジャンプ |
| `jge/jnl rel16` | `0F 8D cw` | 7+m, 3 | ニアジャンプ |
| `jge/jnl rel32` | `0F 8D cd` | 7+m, 3 | ニアジャンプ |

#### jl より小さい / jnge 以上ではない (SF!=OF) (符号あり)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jl/jnge rel8` | `7C cb` | 7+m, 3 | ショートジャンプ |
| `jl/jnge rel16` | `0F 8C cw` | 7+m, 3 | ニアジャンプ |
| `jl/jnge rel32` | `0F 8C cd` | 7+m, 3 | ニアジャンプ |

#### jle 以下 / jng より大きくない (ZF=1 & SF!=OF) (符号あり)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jle/jng rel8` | `7E cb` | 7+m, 3 | ショートジャンプ |
| `jle/jng rel16` | `0F 8E cw` | 7+m, 3 | ニアジャンプ |
| `jle/jng rel32` | `0F 8E cd` | 7+m, 3 | ニアジャンプ |

#### ja より大きい / jnbe 以下ではない (CF=0 & ZF=0) (符号なし)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `ja/jnbe rel8` | `77 cb` | 7+m, 3 | ショートジャンプ |
| `ja/jnbe rel16` | `0F 87 cw` | 7+m, 3 | ニアジャンプ |
| `ja/jnbe rel32` | `0F 87 cd` | 7+m, 3 | ニアジャンプ |

#### jae 以上 / jnb より小さくない / jnc (CF=0) (符号なし)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jae/jnb rel8` | `73 cb` | 7+m, 3 | ショートジャンプ |
| `jae/jnb rel16` | `0F 83 cw` | 7+m, 3 | ニアジャンプ |
| `jae/jnb rel32` | `0F 83 cd` | 7+m, 3 | ニアジャンプ |

#### jb より小さい / jnae 以上ではない / jc (CF=1) (符号なし)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jb/jnae/jc rel8` | `72 cb` | 7+m, 3 | ショートジャンプ |
| `jb/jnae/jc rel16` | `0F 82 cw` | 7+m, 3 | ニアジャンプ |
| `jb/jnae/jc rel32` | `0F 82 cd` | 7+m, 3 | ニアジャンプ |

#### jbe 以上 / jna (CF=1 | ZF=1) (符号なし)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jbe/jna rel8` | `76 cb` | 7+m, 3 | ショートジャンプ |
| `jbe/jna rel16` | `0F 86 cw` | 7+m, 3 | ニアジャンプ |
| `jbe/jna rel32` | `0F 86 cd` | 7+m, 3 | ニアジャンプ |

#### jcxz (cx=0)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jcxz rel8` | `E3 cb` | 9+m, 5 | ショートジャンプ |

#### jecxz (ecx=0)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jecxz rel8` | `E3 cb` | 9+m, 5 | ショートジャンプ |

#### jo (OF=1)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jo rel8` | `70 cb` | 7+m, 3 | ショートジャンプ |
| `jo rel16` | `0F 80 cw` | 7+m, 3 | ニアジャンプ |
| `jo rel32` | `0F 80 cd` | 7+m, 3 | ニアジャンプ |

#### jno (OF=0)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jno rel8` | `71 cb` | 7+m, 3 | ショートジャンプ |
| `jno rel16` | `0F 81 cw` | 7+m, 3 | ニアジャンプ |
| `jno rel32` | `0F 81 cd` | 7+m, 3 | ニアジャンプ |

#### jp (PF=1)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jp rel8` | `7A cb` | 7+m, 3 | ショートジャンプ |
| `jp rel16` | `0F 8A cw` | 7+m, 3 | ニアジャンプ |
| `jp rel32` | `0F 8A cd` | 7+m, 3 | ニアジャンプ |

#### jnp (PF=0)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jnp rel8` | `7B cb` | 7+m, 3 | ショートジャンプ |
| `jnp rel16` | `0F 8B cw` | 7+m, 3 | ニアジャンプ |
| `jnp rel32` | `0F 8B cd` | 7+m, 3 | ニアジャンプ |

#### js (SF=1)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `js rel8` | `78 cb` | 7+m, 3 | ショートジャンプ |
| `js rel16` | `0F 88 cw` | 7+m, 3 | ニアジャンプ |
| `js rel32` | `0F 88 cd` | 7+m, 3 | ニアジャンプ |

#### jns (SF=0)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jns rel8` | `79 cb` | 7+m, 3 | ショートジャンプ |
| `jns rel16` | `0F 89 cw` | 7+m, 3 | ニアジャンプ |
| `jns rel32` | `0F 89 cd` | 7+m, 3 | ニアジャンプ |

### jmp (ジャンプ)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `jmp rel8` | `EB cb` | 7+m | ショートジャンプ |
| `jmp rel16` | `E9 cw` | 7+m | ニアジャンプ |
| `jmp r/m16` | `FF /4` | 7+m/10+m | r/m |
| `jmp ptr16:16` | `EA cd` | 12+m, pm=27+m |  |
| `jmp ptr16:16` | `EA cd` | pm=45+m |  |
| `jmp ptr16:16` | `EA cd` | ts |  |
| `jmp ptr16:16` | `EA cd` | ts |  |
| `jmp m16:16` | `FF /5` | 43+m, pm=31+m |  |
| `jmp m16:16` | `FF /5` | pm=49+m |  |
| `jmp m16:16` | `FF /5` | 5+ts |  |
| `jmp m16:16` | `FF /5` | 5+ts |  |
| `jmp rel32` | `E9 cd` | 7+m | ニアジャンプ |
| `jmp r/m32` | `FF /4` | 7+m, 10+m |  |
| `jmp ptr16:32` | `EA cp` | 12+m, pm=27+m |  |
| `jmp ptr16:32` | `EA cp` | pm=45+m |  |
| `jmp ptr16:32` | `EA cp` | ts |  |
| `jmp ptr16:32` | `EA cp` | ts |  |
| `jmp m16:32` | `FF /5` | 43+m, pm=31m |  |
| `jmp m16:32` | `FF /5` | pm=49+m |  |
| `jmp m16:32` | `FF /5` | 5+ts |  |
| `jmp m16:32` | `FF /5` | 5+ts |  |

### lods (文字列読み込み)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `lods m8` | `AC` | 5 | byte ds:[(e)si]をalに読み込みます |
| `lods m16` | `AD` | 5 | word ds:[(e)si]をaxに読み込みます |
| `lods m32` | `AD` | 5 | dword ds:[(e)si]をeaxに読み込みます |
| `lodsb` | `AC` | 5 | byte ds:[(e)si]をalに読み込みます |
| `lodsw` | `AD` | 5 | word ds:[(e)si]をaxに読み込みます |
| `lodsd` | `AD` | 5 | dword ds:[(e)si]をeaxに読み込みます |

### lea (実効アドレスのロード)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `lea r16, m` | `8D` | 2 | mの実効アドレスをr16に格納します |
| `lea r32, m` | `8D` | 2 | mの実効アドレスをr32に格納します |

| オペランドサイズ [bits] | アドレスサイズ [bits] | 動作 |
|:-:|:-:|---|
| 16 | 16 | 16bitsの実効アドレスが計算され、16bitレジスタに格納されます。 |
| 16 | 32 | 16bitsの実効アドレスが計算され、その下位16bitsが16bitレジスタに格納されます。 |
| 32 | 16 | 16bitsの実効アドレスが計算され、上位16bitsは0で埋められた後、32bitレジスタに格納されます。 |
| 32 | 32 | 32bitsの実効アドレスが計算され、32bitレジスタに格納されます。 |

### mov (データ読み込み)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `mov r/m8, r8` | `88 /r` | 2/2 |  |
| `mov r/m16, r16` | `89 /r` | 2/2 |  |
| `mov r/m32, r32` | `89 /r` | 2/2 |  |
| `mov r8, r/m8` | `8A /r` | 2/4 |  |
| `mov r16, r/m16` | `8B /r` | 2/4 |  |
| `mov r32, r/m32` | `8B /r` | 2/4 |  |
| `mov r/m8, sreg` | `8C /r` | 2/2 |  |
| `mov sreg, r/m8` | `8D /r` | 2/5, pm=18/19 |  |
| `mov al, moffs8` | `A0` | 4 |  |
| `mov ax, moffs16` | `A1` | 4 |  |
| `mov eax, moffs32` | `A1` | 4 |  |
| `mov moffs8, al` | `A2` | 2 |  |
| `mov moffs16, ax` | `A3` | 2 |  |
| `mov moffs32, eax` | `A3` | 2 |  |
| `mov r8, imm8` | `B0 + rb` | 2 |  |
| `mov r16, imm16` | `B0 + rw` | 2 |  |
| `mov r32, imm32` | `B0 + rd` | 2 |  |
| `mov r/m8, imm8` | `C6` | 2/2 |  |
| `mov r/m16, imm16` | `C7` | 2/2 |  |
| `mov r/m32, imm32` | `C7` | 2/2 |  |

### nop (オペレーションなし)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `nop` | `90` | 3 | 何もしません |

### or (論理和)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `or al, imm8` | `0C ib` | 2 |  |
| `or ax, imm16` | `0D iw` | 2 |  |
| `or eax, imm32` | `0D id` | 2 |  |
| `or r/m8, imm8` | `80 /1 ib` | 2/7 |  |
| `or r/m16, imm16` | `81 /1 iw` | 2/7 |  |
| `or r/m32, imm32` | `81 /1 id` | 2/7 |  |
| `or r/m16, imm8` | `83 /1 ib` | 2/7 |  |
| `or r/m32, imm8` | `83 /1 ib` | 2/7 |  |
| `or r/m8, r8` | `08 /r` | 2/6 |  |
| `or r/m16, r16` | `09 /r` | 2/6 |  |
| `or r/m32, r32` | `09 /r` | 2/6 |  |
| `or r8, r/m8` | `0A /r` | 2/7 |  |
| `or r16, r/m16` | `0B /r` | 2/7 |  |
| `or r32, r/m32` | `0B /r` | 2/7 |  |

### ret (処理から戻る)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `ret` | `C3` | 10+m |  |
| `ret` | `CB` | 18+m, pm=32+m |  |
| `ret` | `CB` | pm=68 |  |
| `ret imm16` | `C2 iw` | 10+m |  |
| `ret imm16` | `CA iw` | 18+m, pm=32+m |  |
| `ret imm16` | `CA iw` | pm=68 |  |

### xor (排他的論理和)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `xor al, imm8` | `34 ib` | 2 |  |
| `xor ax, imm16` | `35 iw` | 2 |  |
| `xor eax, imm32` | `35 id` | 2 |  |
| `xor r/m8, imm8` | `80 /6 ib` | 2/7 |  |
| `xor r/m16, imm16` | `81 /6 iw` | 2/7 |  |
| `xor r/m32, imm32` | `81 /6 id` | 2/7 |  |
| `xor r/m16, imm8` | `83 /6 ib` | 2/7 |  |
| `xor r/m32, imm8` | `83 /6 ib` | 2/7 |  |
| `xor r/m8, r8` | `30 /r` | 2/6 |  |
| `xor r/m16, r16` | `31 /r` | 2/6 |  |
| `xor r/m32, r32` | `31 /r` | 2/6 |  |
| `xor r8, r/m8` | `32 /r` | 2/7 |  |
| `xor r16, r/m16` | `33 /r` | 2/7 |  |
| `xor r32, r/m32` | `33 /r` | 2/7 |  |

### cli (割込フラグのセット)
| 命令 | オペコード | クロック数 | 説明 |
|---|:-:|:-:|---|
| `cli` | `FB` | 3 | 割込みフラグ(IF)のセット(割込の有効化) |
